################################
##### Queries messages #####
################################

query test {
  auth0 {
    email
  }
}

query GetMessages {
  messages {
    contenu
    updated_at
    utilisateur {
      id
      pseudonyme
    }
    id
  }
}

################################
#### Mutations messages ####
################################

mutation AddMessage($message: String!, $userId: Int!) {
  insert_messages_one(object: { contenu: $message, id_utilisateur: $userId }) {
    id
  }
}

mutation DeleteMessage($messageId: Int!) {
  delete_messages(where: { id: { _eq: $messageId } }) {
    affected_rows
  }
}

################################
#### Subscriptions messages ####
################################

subscription GetMessagesSub {
  messages(order_by: { updated_at: asc }) {
    id
    contenu
    updated_at
    utilisateur {
      id
      pseudonyme
    }
  }
}
